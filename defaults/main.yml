---
# INSTALLATION
php_version: 8.2

php_default_packages:
  - "{{ 'php' + php_version | replace('.', '') }}"
  - "{{ 'php' + php_version | replace('.', '') + '-php-cli' }}"
  - "{{ 'php' + php_version | replace('.', '') + '-php-common' }}"
  - "{{ 'php' + php_version | replace('.', '') + '-php-devel' }}"
  - "{{ 'php' + php_version | replace('.', '') + '-php-fpm' }}"
  - "{{ 'php' + php_version | replace('.', '') + '-php-gd' }}"
  - "{{ 'php' + php_version | replace('.', '') + '-php-intl' }}"
  - "{{ 'php' + php_version | replace('.', '') + '-php-mbstring' }}"
  - "{{ 'php' + php_version | replace('.', '') + '-php-mysqlnd' }}"
  - "{{ 'php' + php_version | replace('.', '') + '-php-pdo' }}"
  - "{{ 'php' + php_version | replace('.', '') + '-php-pear' }}"
  - "{{ 'php' + php_version | replace('.', '') + '-php-pecl-uuid' }}"
  - "{{ 'php' + php_version | replace('.', '') + '-php-pecl-yaml' }}"
  - "{{ 'php' + php_version | replace('.', '') + '-php-tidy' }}"
  - "{{ 'php' + php_version | replace('.', '') + '-php-xml' }}"
  - "{{ 'php' + php_version | replace('.', '') + '-runtime' }}"
  - "{{ 'php' + php_version | replace('.', '') + '-php-pecl-imagick' }}"
  - "{{ 'php' + php_version | replace('.', '') + '-php-opcache' }}"
  - "{{ 'php' + php_version | replace('.', '') + '-php-pecl-memcached' }}"
  - "{{ 'php' + php_version | replace('.', '') + '-php-pecl-mcrypt' }}"
  - "{{ 'php' + php_version | replace('.', '') + '-php-pecl-mysql' }}"
  - "{{ 'php' + php_version | replace('.', '') + '-php-pecl-zip' }}"
  - "{{ 'php' + php_version | replace('.', '') + '-php-pecl-igbinary' }}"
  - "{{ 'php' + php_version | replace('.', '') + '-php-process' }}"

php_extra_packages: []

# PHP INI Settings
php_ini_path: "{{ '/etc/opt/remi/php' + php_version | replace('.', '') + '/php.ini'}}"

php_ini_settings: 
  - allow_url_fopen: "On"
    assert_active: "On"  # sau -1  # assert.active
    date_timezone: "UTC" # date.timezone
    display_errors: "Off"
    display_startup_errors: "Off"
    error_log: "syslog"
    expose_php: "Off"
    file_uploads: "On"
    mail_add_x_header: "0" # mail.add_x_header
    max_execution_time: "180"
    max_file_uploads: "20"
    max_input_time: "60"
    max_input_vars: "10000"
    memory_limit: "512M"
    post_max_size: "200M"
    realpath_cache_size: "4096k"
    upload_max_filesize: "200M"

# PHP FPM POOL Settings
php_fpm_service: "{{ 'php' + php_version | replace('.', '') + '-php-fpm' }}"
php_fpm_enable: true 

php_fpm_pools:
  - name: "www"
    user: nginx
    group: nginx
    listen: "{{ '/var/run/php' + php_version | replace('.', '') + '-php-fpm.sock' }}"
    listen_owner: nginx # listen.owner
    listen_group: nginx # lsiten.group
    listen_mode: 0660 # listen.mode
    pm_max_children: 50 # pm.max_children
    pm_start_servers: 10 # pm.start_servers
    pm_min_spare_servers: 10 # pm.min_spare_servers
    pm_max_spare_servers: 20 # pm.max_spare_servers
    pm_max_requests: 500 # pm.max_requests
